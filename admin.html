<!DOCTYPE html>
<html lang="ru">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="theme-color" content="#2ecc71">
        <meta name="description" content="–°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–¥–ø–∏—Å–∫–∞–º–∏ GreenFood">
        <meta name="mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
        <meta name="apple-mobile-web-app-title" content="GreenFood">
        
        <link rel="manifest" href="manifest.json">
        <link rel="icon" type="image/png" sizes="192x192" href="icon-192.png">
        <link rel="apple-touch-icon" href="icon-192.png">
        
        <title>GreenFood Admin</title>
        <link rel="stylesheet" href="admin.css">
    </head>
<body>
    <div id="mainApp">
        <header>
            <div class="header-content">
                <h1>üåø GreenFood Admin</h1>
                <div class="header-actions">
                    <button class="theme-toggle" onclick="toggleTheme()" title="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É">
                        <span class="theme-icon">üåô</span>
                    </button>
                    <button class="btn-export" onclick="exportData()" title="–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö">
                        üíæ
                    </button>
                    <button class="btn-import" onclick="importData()" title="–ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö">
                        üìÇ
                    </button>
                </div>
            </div>
        </header>

        <div class="container">
            <nav>
                <button class="nav-btn active" onclick="showPage('main')">–ì–ª–∞–≤–Ω–∞—è</button>
                <button class="nav-btn" onclick="showPage('users')">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</button>
                <button class="nav-btn" onclick="showPage('expired')">–ü—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã–µ</button>
                <button class="nav-btn" onclick="showPage('bazaar')">–ë–∞–∑–∞—Ä</button>
                <button class="nav-btn" onclick="showPage('calculator')">–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä</button>
                <button class="nav-btn" onclick="showPage('statistics')">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</button>
            </nav>

            <div id="main" class="page active">
                <div class="action-buttons">
                    <button class="btn btn-add" onclick="openModal()">‚ûï –î–æ–±–∞–≤–∏—Ç—å</button>
                    <button class="btn btn-delete" onclick="deleteSelected()">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</button>
                </div>

                <div id="mainUsersList"></div>
            </div>

            <div id="users" class="page">
                <div class="filter-bar">
                    <input type="text" id="searchInput" placeholder="üîç –ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏..." oninput="filterUsers()">
                    <select id="filterPackage" onchange="filterUsers()">
                        <option value="">–í—Å–µ –ø–∞–∫–µ—Ç—ã</option>
                        <option value="Standart">Standart</option>
                        <option value="Balance Lite">Balance Lite</option>
                        <option value="–î–∏–∞–±–µ—Ç">–î–∏–∞–±–µ—Ç</option>
                        <option value="Energy Sport">Energy Sport</option>
                        <option value="Power Sport">Power Sport</option>
                        <option value="Power XL">Power XL</option>
                        <option value="Power 2XL">Power 2XL</option>
                        <option value="Power 3XL">Power 3XL</option>
                        <option value="Power 4XL">Power 4XL</option>
                    </select>
                </div>
                <div id="usersList"></div>
            </div>

            <div id="expired" class="page">
                <div class="expired-header">
                    <h2>‚ö†Ô∏è –ü—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã–µ –ø–æ–¥–ø–∏—Å–∫–∏</h2>
                    <button class="btn btn-add" onclick="archiveExpired()">üì¶ –ê—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ</button>
                </div>
                <div id="expiredList"></div>
            </div>

            <div id="bazaar" class="page">
                <div class="bazaar-header">
                    <h2>üõí –ë–∞–∑–∞—Ä - –£—á–µ—Ç —Ä–∞—Å—Ö–æ–¥–æ–≤</h2>
                    <button class="btn btn-add" onclick="openExpenseModal()">‚ûï –î–æ–±–∞–≤–∏—Ç—å —Ç—Ä–∞—Ç—ã</button>
                </div>

                <div class="bazaar-stats">
                    <div class="stat-card">
                        <div class="stat-icon">üí∞</div>
                        <div class="stat-value" id="bazaarTotalRevenue">0 —Å—É–º</div>
                        <div class="stat-label">–û–±—â–∏–π –¥–æ—Ö–æ–¥</div>
                    </div>
                    <div class="stat-card stat-danger">
                        <div class="stat-icon">üí∏</div>
                        <div class="stat-value" id="bazaarTotalExpenses">0 —Å—É–º</div>
                        <div class="stat-label">–í—Å–µ–≥–æ —Ä–∞—Å—Ö–æ–¥–æ–≤</div>
                    </div>
                    <div class="stat-card" style="border: 2px solid var(--accent-green);">
                        <div class="stat-icon">üìä</div>
                        <div class="stat-value" id="bazaarProfit">0 —Å—É–º</div>
                        <div class="stat-label">–ß–∏—Å—Ç–∞—è –ø—Ä–∏–±—ã–ª—å</div>
                    </div>
                </div>

                <div class="expenses-list">
                    <h3>üìù –ò—Å—Ç–æ—Ä–∏—è —Ä–∞—Å—Ö–æ–¥–æ–≤</h3>
                    <div id="expensesList"></div>
                </div>
            </div>

            <div id="calculator" class="page">
                <div class="calculator-card">
                    <h2>üí∞ –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Ü–µ–Ω</h2>
                    <div class="price-list">
                        <h3>–¶–µ–Ω—ã –∑–∞ 1 –¥–µ–Ω—å:</h3>
                        <div class="price-grid">
                            <div class="price-item">
                                <span class="package-name">Standart</span>
                                <span class="package-price">100.000 —Å—É–º</span>
                            </div>
                            <div class="price-item">
                                <span class="package-name">Balance Lite</span>
                                <span class="package-price">120.000 —Å—É–º</span>
                            </div>
                            <div class="price-item">
                                <span class="package-name">–î–∏–∞–±–µ—Ç</span>
                                <span class="package-price">145.000 —Å—É–º</span>
                            </div>
                            <div class="price-item">
                                <span class="package-name">Energy Sport</span>
                                <span class="package-price">150.000 —Å—É–º</span>
                            </div>
                            <div class="price-item">
                                <span class="package-name">Power Sport</span>
                                <span class="package-price">210.000 —Å—É–º</span>
                            </div>
                            <div class="price-item">
                                <span class="package-name">Power XL</span>
                                <span class="package-price">250.000 —Å—É–º</span>
                            </div>
                            <div class="price-item">
                                <span class="package-name">Power 2XL</span>
                                <span class="package-price">300.000 —Å—É–º</span>
                            </div>
                            <div class="price-item">
                                <span class="package-name">Power 3XL</span>
                                <span class="package-price">350.000 —Å—É–º</span>
                            </div>
                            <div class="price-item">
                                <span class="package-name">Power 4XL</span>
                                <span class="package-price">400.000 —Å—É–º</span>
                            </div>
                        </div>
                        
                        <div class="discount-info">
                            <h3>üéÅ –°–∫–∏–¥–∫–∏:</h3>
                            <ul>
                                <li>1 –¥–µ–Ω—å (–ø—Ä–æ–±–Ω—ã–π) - <strong>10% —Å–∫–∏–¥–∫–∞</strong></li>
                                <li>10+ –¥–Ω–µ–π - <strong>10% —Å–∫–∏–¥–∫–∞</strong></li>
                                <li>26 –¥–Ω–µ–π - <strong>20% —Å–∫–∏–¥–∫–∞ + 4 –¥–Ω—è –≤ –ø–æ–¥–∞—Ä–æ–∫</strong></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <div id="statistics" class="page">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">üë•</div>
                        <div class="stat-value" id="totalUsers">0</div>
                        <div class="stat-label">–í—Å–µ–≥–æ –∫–ª–∏–µ–Ω—Ç–æ–≤</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">‚úÖ</div>
                        <div class="stat-value" id="activeUsers">0</div>
                        <div class="stat-label">–ê–∫—Ç–∏–≤–Ω—ã—Ö</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">‚è∏Ô∏è</div>
                        <div class="stat-value" id="pausedUsers">0</div>
                        <div class="stat-label">–ù–∞ –ø–∞—É–∑–µ</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">‚ö†Ô∏è</div>
                        <div class="stat-value" id="expiredUsersCount">0</div>
                        <div class="stat-label">–ü—Ä–æ—Å—Ä–æ—á–µ–Ω–æ</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üí∞</div>
                        <div class="stat-value" id="totalRevenue">0 —Å—É–º</div>
                        <div class="stat-label">–û–±—â–∏–π –¥–æ—Ö–æ–¥</div>
                    </div>
                    <div class="stat-card stat-danger">
                        <div class="stat-icon">üìâ</div>
                        <div class="stat-value" id="overdueRevenue">0 —Å—É–º</div>
                        <div class="stat-label">–ó–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç—å</div>
                    </div>
                </div>
                
                <div class="popular-packages">
                    <h3>üìä –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –ø–∞–∫–µ—Ç—ã</h3>
                    <div id="packageStats"></div>
                </div>
            </div>
        </div>

        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
        <div id="addModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>–î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h2>
                    <button class="close-btn" onclick="closeModal()">&times;</button>
                </div>
                
                <form id="addUserForm" onsubmit="addUser(event)">
                    <div class="form-group">
                        <label>–ò–º—è</label>
                        <input type="text" id="firstName" required>
                    </div>

                    <div class="form-group">
                        <label>–§–∞–º–∏–ª–∏—è</label>
                        <input type="text" id="lastName" required>
                    </div>

                    <div class="form-group">
                        <label>–¢–µ–ª–µ—Ñ–æ–Ω (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label>
                        <input type="tel" id="phone" placeholder="+998 90 123 45 67">
                    </div>

                    <div class="form-group">
                        <label>Telegram (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label>
                        <input type="text" id="telegram" placeholder="@username –∏–ª–∏ username" oninput="formatTelegram(this)">
                        <small style="color: var(--text-secondary); font-size: 12px;">–í–≤–µ–¥–∏—Ç–µ username —Å @ –∏–ª–∏ –±–µ–∑</small>
                    </div>

                    <div class="form-group">
                        <label>–ü–∞–∫–µ—Ç</label>
                        <select id="package" required onchange="calculatePrice()">
                            <option value="Standart">Standart - 100.000 —Å—É–º/–¥–µ–Ω—å</option>
                            <option value="Balance Lite">Balance Lite - 120.000 —Å—É–º/–¥–µ–Ω—å</option>
                            <option value="–î–∏–∞–±–µ—Ç">–î–∏–∞–±–µ—Ç - 145.000 —Å—É–º/–¥–µ–Ω—å</option>
                            <option value="Energy Sport">Energy Sport - 150.000 —Å—É–º/–¥–µ–Ω—å</option>
                            <option value="Power Sport">Power Sport - 210.000 —Å—É–º/–¥–µ–Ω—å</option>
                            <option value="Power XL">Power XL - 250.000 —Å—É–º/–¥–µ–Ω—å</option>
                            <option value="Power 2XL">Power 2XL - 300.000 —Å—É–º/–¥–µ–Ω—å</option>
                            <option value="Power 3XL">Power 3XL - 350.000 —Å—É–º/–¥–µ–Ω—å</option>
                            <option value="Power 4XL">Power 4XL - 400.000 —Å—É–º/–¥–µ–Ω—å</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>–°–∫–æ–ª—å–∫–æ –¥–Ω–µ–π (1-26)</label>
                        <input type="number" id="days" min="1" max="26" required oninput="calculatePrice()">
                    </div>

                    <div class="form-group">
                        <label>–î–∞—Ç–∞ –∑–∞–∫–∞–∑–∞</label>
                        <input type="date" id="orderDate" required>
                    </div>

                    <div id="priceCalculation" class="price-calculation" style="display: none;">
                        <div class="calc-row">
                            <span>–ë–∞–∑–æ–≤–∞—è —Ü–µ–Ω–∞:</span>
                            <span id="basePrice">0 —Å—É–º</span>
                        </div>
                        <div class="calc-row discount" id="discountRow" style="display: none;">
                            <span id="discountLabel">–°–∫–∏–¥–∫–∞:</span>
                            <span id="discountAmount">0 —Å—É–º</span>
                        </div>
                        <div class="calc-row bonus" id="bonusRow" style="display: none;">
                            <span>üéÅ –ë–æ–Ω—É—Å:</span>
                            <span id="bonusDays">+4 –¥–Ω—è</span>
                        </div>
                        <div class="calc-row total">
                            <span>–ò—Ç–æ–≥–æ:</span>
                            <span id="totalPrice">0 —Å—É–º</span>
                        </div>
                    </div>

                    <button type="submit" class="btn btn-add" style="width: 100%;">–î–æ–±–∞–≤–∏—Ç—å</button>
                </form>
            </div>
        </div>

        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ä–∞—Å—Ö–æ–¥–æ–≤ -->
        <div id="expenseModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>üí∏ –î–æ–±–∞–≤–∏—Ç—å —Ç—Ä–∞—Ç—ã</h2>
                    <button class="close-btn" onclick="closeExpenseModal()">&times;</button>
                </div>
                
                <form id="addExpenseForm" onsubmit="addExpense(event)">
                    <div class="form-group">
                        <label>–û–ø–∏—Å–∞–Ω–∏–µ</label>
                        <input type="text" id="expenseDescription" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ü–æ–∫—É–ø–∫–∞ –ø—Ä–æ–¥—É–∫—Ç–æ–≤" required>
                    </div>

                    <div class="form-group">
                        <label>–°—É–º–º–∞ (—Å—É–º)</label>
                        <input type="number" id="expenseAmount" placeholder="0" min="1" required>
                    </div>

                    <div class="form-group">
                        <label>–î–∞—Ç–∞</label>
                        <input type="date" id="expenseDate" required>
                    </div>

                    <button type="submit" class="btn btn-add" style="width: 100%;">–î–æ–±–∞–≤–∏—Ç—å</button>
                </form>
            </div>
        </div>

        <input type="file" id="importFile" accept=".json" style="display: none;" onchange="handleImport(event)">
    </div>

    <script src="admin.js"></script>
</body>
</html>
